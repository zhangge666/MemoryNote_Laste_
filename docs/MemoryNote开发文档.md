# MemoryNote - 个人学习知识库系统开发文档

## 项目概述

### 项目简介
MemoryNote是一个基于Electron + Vue3的桌面端个人学习知识库系统，旨在为用户提供统一的学习资料管理与智能复习提醒功能。系统结合艾宾浩斯遗忘曲线、自然语言处理技术和大型语言模型，实现智能化的知识管理、检索、问答和复习提醒。

### 核心功能
1. **多格式笔记支持**：支持Markdown、Word等格式的笔记记录
2. **智能复习提醒**：基于艾宾浩斯遗忘曲线的复习计划
3. **语义检索**：基于NLP技术的智能知识检索
4. **AI问答**：结合LLM的智能问答系统
5. **知识对比**：AI辅助的知识错误检测和遗漏提醒
6. **标签页系统**：支持多标签页管理、嵌套分区、状态缓存
7. **插件化扩展**：支持个性化功能扩展

### 技术栈
- **前端框架**：Vue 3 + TypeScript
- **桌面应用**：Electron
- **构建工具**：Vite
- **状态管理**：Pinia
- **样式框架**：Tailwind CSS
- **UI组件**：Element Plus / Ant Design Vue
- **编辑器**：CodeMirror 6 / Toast UI Editor / 自定义方案
- **数据库**：SQLite + IndexedDB
- **AI集成**：支持多厂商LLM API

---

## 系统架构设计

### 整体架构图

```
┌─────────────────────────────────────────────────────────────┐
│                    MemoryNote 桌面应用                        │
├─────────────────────────────────────────────────────────────┤
│  前端层 (Vue3 + Electron)                                    │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐            │
│  │  主界面     │ │  编辑器     │ │  设置面板   │            │
│  └─────────────┘ └─────────────┘ └─────────────┘            │
├─────────────────────────────────────────────────────────────┤
│  业务逻辑层                                                   │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐            │
│  │  笔记管理   │ │  复习算法   │ │  AI服务     │            │
│  └─────────────┘ └─────────────┘ └─────────────┘            │
├─────────────────────────────────────────────────────────────┤
│  数据层                                                       │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐            │
│  │  SQLite     │ │  IndexedDB  │ │  文件系统   │            │
│  └─────────────┘ └─────────────┘ └─────────────┘            │
├─────────────────────────────────────────────────────────────┤
│  外部服务                                                     │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐            │
│  │  阿里云API  │ │  百度API    │ │  其他LLM    │            │
│  └─────────────┘ └─────────────┘ └─────────────┘            │
└─────────────────────────────────────────────────────────────┘
```

### 模块架构

#### 1. 核心模块
- **笔记管理模块**：笔记的增删改查、格式转换
- **复习算法模块**：艾宾浩斯遗忘曲线实现
- **AI服务模块**：LLM集成、语义检索、问答
- **插件系统模块**：插件加载、管理、扩展

#### 2. 数据模块
- **本地数据库**：SQLite存储结构化数据
- **文件存储**：本地文件系统存储笔记文件
- **缓存系统**：IndexedDB存储临时数据和缓存

#### 3. 界面模块
- **主界面**：笔记列表、搜索、分类
- **编辑器**：实时渲染的Markdown编辑器
- **设置界面**：AI配置、复习设置、插件管理

---

## 技术选型详解

### 前端技术栈

#### 1. Vue 3 + TypeScript + Tailwind CSS
- **Vue 3 Composition API**：使用最新的组合式API
- **TypeScript**：提供类型安全和更好的开发体验
- **Tailwind CSS**：原子化CSS框架，快速构建响应式界面
- **项目结构**：模块化组件设计，清晰的目录结构

#### 2. Electron配置
- **无边框窗口**：自定义标题栏设计
- **IPC通信**：主进程与渲染进程通信
- **安全配置**：contextIsolation和nodeIntegration设置
- **开发环境**：热重载和开发工具集成

#### 3. Vite配置
- **快速构建**：基于ESBuild的快速构建工具
- **HMR支持**：热模块替换
- **路径别名**：@指向src目录
- **构建优化**：生产环境优化配置

#### 4. Tailwind CSS配置
- **原子化CSS**：快速构建响应式界面
- **主题系统**：深色/浅色主题切换
- **自定义配置**：项目特定的颜色和尺寸
- **JIT模式**：按需生成CSS，减少包体积

### 数据库设计

#### 1. SQLite数据库结构
- **notes表**：存储笔记基本信息（标题、内容、格式、标签等）
- **categories表**：笔记分类管理（支持层级结构）
- **review_records表**：复习记录（艾宾浩斯遗忘曲线数据）
- **ai_configs表**：AI服务配置（多厂商API配置）
- **plugins表**：插件管理（插件信息和配置）

#### 2. 数据模型定义
- **Note接口**：笔记数据结构
- **Category接口**：分类数据结构
- **ReviewRecord接口**：复习记录结构
- **AIConfig接口**：AI配置结构
- **Plugin接口**：插件数据结构

---

## UI界面设计

### 整体布局结构

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│ 顶部栏 (无系统菜单栏)                                                              │
│ ┌─────────┬─────────────────────────────────────────────┬─────────────────────┐ │
│ │ 🧠图标  │ [≡] [🔍] 搜索框                            │ [≡] [-] [□] [×]     │ │
│ └─────────┴─────────────────────────────────────────────┴─────────────────────┘ │
├─────────────────────────────────────────────────────────────────────────────────┤
│ 内容区域                                                                        │
│ ┌─────────┬─────────────┬─────────────────────────────┬─────────────────────┐ │
│ │侧边导航 │ 左侧栏      │ 工作区域                    │ 右侧栏              │ │
│ │ ┌─────┐ │ ┌─────────┐ │ ┌─────────────────────────┐ │ ┌─────────────────┐ │ │
│ │ │📄文档│ │ │📁 全部笔记│ │ │ 笔记列表/编辑器        │ │ │ 笔记大纲        │ │ │
│ │ │📅日记│ │ │📚 分类1 │ │ │ ┌─────────────────────┐ │ │ │ 标签云          │ │ │
│ │ │🔄复习│ │ │📚 分类2 │ │ │ │ 笔记1 [编辑] [复习] │ │ │ │ 相关笔记        │ │ │
│ │ │🔍搜索│ │ │🏷️ 标签  │ │ │ └─────────────────────┘ │ │ │ AI助手          │ │ │
│ │ │     │ │ │         │ │ │ ┌─────────────────────┐ │ │ └─────────────────┘ │ │
│ │ │     │ │ │         │ │ │ │ 笔记2 [编辑] [复习] │ │ │                     │ │
│ │ │     │ │ │         │ │ │ └─────────────────────┘ │ │                     │ │
│ │ └─────┘ │ └─────────┘ │ └─────────────────────────┘ │                     │ │
│ │ 👤用户  │             │                             │                     │ │
│ │ ⚙️设置  │             │                             │                     │ │
│ └─────────┴─────────────┴─────────────────────────────┴─────────────────────┘ │
├─────────────────────────────────────────────────────────────────────────────────┤
│ 底部栏                                                                          │
│ ┌─────────────────────────────────────────────────────────────────────────────┐ │
│ │ 🔗 连接状态 | 📁 工作区目录名称                    │ 📊 复习: 5张 | 📝 笔记: 23篇 │ │
│ └─────────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 详细界面设计

#### 1. 顶部栏设计
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│ 🧠 MemoryNote    [≡] [🔍 搜索笔记...]                    [≡] [-] [□] [×]        │
└─────────────────────────────────────────────────────────────────────────────────┘
```

**功能说明：**
- 左侧：软件图标 + 左侧栏切换按钮 + 搜索框
- 右侧：右侧栏切换按钮 + 窗口控制按钮（最小化、最大化、关闭）
- 无系统菜单栏，完全自定义标题栏

#### 2. 侧边导航栏设计
```
┌─────────┐
│ 📄 文档  │  ← 笔记管理
│ 📅 日记  │  ← 日记功能
│ 🔄 复习  │  ← 复习计划
│ 🔍 搜索  │  ← 全局搜索
│         │
│         │
│         │
│         │
│ 👤 用户  │  ← 用户头像
│ ⚙️ 设置  │  ← 设置按钮
└─────────┘
```

#### 3. 左侧栏设计
```
┌─────────────┐
│ 📁 全部笔记  │
│ 📚 分类1    │
│ 📚 分类2    │
│ 🏷️ 标签     │
│ 🔌 插件     │
│ 📊 统计     │
│             │
│             │
└─────────────┘
```

#### 4. 工作区域设计（带标签页系统）
```
┌─────────────────────────────────────────────────────────┐
│ 标签页栏                                                │
│ ┌─────────┬─────────┬─────────┬─────────┬─────────┐   │
│ │📄 笔记1 │📅 日记  │⚙️ 设置  │🔍 搜索  │[+] 新建  │   │
│ └─────────┴─────────┴─────────┴─────────┴─────────┘   │
├─────────────────────────────────────────────────────────┤
│ 标签页内容区域                                          │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 笔记列表模式                                        │ │
│ │ ┌─────────────────────────────────────────────────┐ │ │
│ │ │ 📝 笔记标题1        [编辑] [复习]               │ │ │
│ │ │ 📝 笔记标题2        [编辑] [复习]               │ │ │
│ │ │ 📝 笔记标题3        [编辑] [复习]               │ │ │
│ │ └─────────────────────────────────────────────────┘ │ │
│ │                                                     │ │
│ │ 编辑器模式                                          │ │
│ │ ┌─────────────────┐ ┌─────────────────────────────┐ │ │
│ │ │ 编辑区域         │ │ 预览区域                    │ │ │
│ │ │ # 标题          │ │ 标题                        │ │ │
│ │ │ ## 子标题       │ │ 子标题                      │ │ │
│ │ │ - 列表项        │ │ • 列表项                    │ │ │
│ │ │ ```代码         │ │ 代码块                      │ │ │
│ │ │ ```            │ │                            │ │ │
│ │ └─────────────────┘ └─────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

#### 5. 右侧栏设计
```
┌─────────────────┐
│ 📋 笔记大纲      │
│ - 标题1         │
│ - 标题2         │
│ - 标题3         │
│                 │
│ 🏷️ 标签云        │
│ #标签1 #标签2    │
│                 │
│ 🔗 相关笔记      │
│ - 相关笔记1     │
│ - 相关笔记2     │
│                 │
│ 🤖 AI助手       │
│ [智能问答]      │
│ [知识对比]      │
└─────────────────┘
```

#### 6. 底部栏设计
```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 🔗 已连接 | 📁 工作区: /Users/username/Notes    │ 📊 复习: 5张 | 📝 笔记: 23篇 │
└─────────────────────────────────────────────────────────────────────────────┘

进入具体笔记时：
┌─────────────────────────────────────────────────────────────────────────────┐
│ 🔗 已连接 | 📁 工作区: /Users/username/Notes    │ 📄 行: 45 | 📊 列: 12 | 字数: 1,234 │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### 7. 设置界面设计
```
┌─────────────────────────────────────────────────────────────┐
│  设置                                                       │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐ ┌─────────────────────────────────────────┐ │
│  │ 设置分类     │ │ 设置内容                                │ │
│  │             │ │                                         │ │
│  │ 📝 笔记设置  │ │ 默认格式: [Markdown ▼]                  │ │
│  │ 🤖 AI设置   │ │ 自动保存: [✓] 开启                      │ │
│  │ 📅 复习设置  │ │ 编辑器主题: [Dark ▼]                   │ │
│  │ 🔌 插件管理  │ │                                         │ │
│  │ 🎨 界面设置  │ │ AI服务商: [阿里云 ▼]                    │ │
│  │ 📊 数据管理  │ │ API Key: [****************]            │ │
│  │             │ │ API Secret: [****************]         │ │
│  │             │ │ 模型: [qwen-turbo ▼]                   │ │
│  │             │ │                                         │ │
│  │             │ │ 复习间隔: [1天 ▼] [3天 ▼] [7天 ▼]      │ │
│  │             │ │ 提醒时间: [09:00]                      │ │
│  └─────────────┘ └─────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### 界面交互设计

#### 1. 响应式布局
- **侧边栏可收缩**：点击顶部栏的[≡]按钮可收缩/展开侧边栏
- **右侧栏可收缩**：点击顶部栏右侧的[≡]按钮可收缩/展开右侧栏
- **工作区域自适应**：根据侧边栏和右侧栏的显示状态自动调整宽度

#### 2. 状态管理
- **当前页面状态**：记录当前所在的页面（文档、日记、复习、搜索）
- **侧边栏状态**：记录左侧栏和右侧栏的展开/收缩状态
- **编辑器状态**：记录编辑器的模式（列表/编辑/预览）

#### 3. 快捷键设计
```
Ctrl + N        - 新建笔记
Ctrl + S        - 保存笔记
Ctrl + F        - 搜索
Ctrl + B        - 切换侧边栏
Ctrl + Shift + B - 切换右侧栏
Ctrl + 1-4      - 切换到不同页面
F11             - 全屏模式
```

#### 4. 主题设计
- **深色主题**：适合夜间使用
- **浅色主题**：适合白天使用
- **自动主题**：根据系统时间自动切换
- **自定义主题**：支持用户自定义颜色方案

### Vue组件架构设计

#### 1. 主要组件结构
- **layout组件**：AppHeader、AppSidebar、AppLeftPanel、AppRightPanel、AppFooter、AppMain
- **tabs组件**：TabBar、TabItem、TabContent、TabManager（标签页管理）
- **editor组件**：MarkdownEditor、NotePreview、EditorToolbar
- **notes组件**：NoteList、NoteItem、NoteSearch
- **review组件**：ReviewList、ReviewCard、ReviewSettings
- **ai组件**：AIChat、AIAnalysis、AISettings
- **views页面**：DocumentsView、DiaryView、ReviewView、SearchView、SettingsView
- **stores状态**：app、notes、review、ai、tabs状态管理

#### 2. 核心组件功能
- **AppHeader**：顶部栏，包含logo、搜索框、侧边栏切换、窗口控制
- **AppSidebar**：侧边导航栏，包含页面导航和用户信息
- **AppFooter**：底部栏，显示连接状态、工作区信息、统计信息
- **AppLeftPanel**：左侧栏，笔记分类和文件管理
- **AppRightPanel**：右侧栏，笔记大纲、标签云、AI助手
- **AppMain**：主内容区域，笔记列表和编辑器

#### 3. 状态管理设计
- **app状态**：页面导航、侧边栏状态、连接状态、编辑器状态
- **tabs状态**：标签页管理、标签页状态缓存、嵌套分区、切换历史
- **notes状态**：笔记列表、分类管理、搜索功能、当前笔记
- **review状态**：复习记录、复习计划、复习统计
- **ai状态**：AI配置、AI对话历史、AI分析结果

#### 4. 样式设计
- **Tailwind CSS**：原子化CSS框架，快速构建响应式界面
- **主题系统**：深色/浅色主题切换，支持自定义主题
- **响应式设计**：适配不同屏幕尺寸
- **组件样式**：统一的组件样式规范

#### 5. Electron主进程配置
- **主进程**：窗口管理、数据库初始化、IPC通信
- **预加载脚本**：安全的API暴露给渲染进程
- **数据库集成**：SQLite数据库操作
- **服务集成**：AI服务和复习服务

#### 6. 项目配置文件
- **package.json**：项目依赖、脚本命令、构建配置
- **vite.config.ts**：Vite构建配置、插件设置
- **tsconfig.json**：TypeScript编译配置
- **tailwind.config.js**：Tailwind CSS配置

---

## 核心功能实现

### 1. 艾宾浩斯遗忘曲线算法
- **间隔计算**：根据复习结果调整下次复习间隔
- **难度适应**：根据内容难度调整复习频率
- **智能提醒**：基于遗忘曲线的复习计划

### 2. AI服务集成
- **多厂商支持**：阿里云、百度、OpenAI等
- **语义搜索**：基于NLP的智能检索
- **智能问答**：结合本地知识库的AI问答
- **知识对比**：AI辅助的错误检测和遗漏提醒

### 3. 插件系统
- **插件接口**：标准化的插件开发接口
- **热加载**：支持插件的动态加载和卸载
- **钩子系统**：插件与主系统的交互机制

---

## 开发计划

### 第一阶段：基础框架（4周）
- [ ] 项目初始化和环境搭建
- [ ] Electron + Vue3 + TypeScript基础架构
- [ ] 基础UI组件和布局
- [ ] SQLite数据库集成
- [ ] 基础笔记CRUD功能

### 第二阶段：核心功能（6周）
- [ ] Markdown编辑器集成（Monaco Editor）
- [ ] 实时预览功能
- [ ] 文件导入导出功能
- [ ] 艾宾浩斯遗忘曲线算法实现
- [ ] 复习提醒功能

### 第三阶段：AI集成（4周）
- [ ] 多厂商LLM API集成
- [ ] 语义搜索功能
- [ ] AI问答功能
- [ ] 知识对比和错误检测
- [ ] AI配置管理

### 第四阶段：高级功能（4周）
- [ ] 插件系统开发
- [ ] 主题和个性化设置
- [ ] 数据同步和备份
- [ ] 性能优化
- [ ] 错误处理和日志系统

### 第五阶段：测试和发布（2周）
- [ ] 单元测试和集成测试
- [ ] 用户界面测试
- [ ] 性能测试
- [ ] 打包和发布准备

---

## 技术难点和解决方案

### 1. 实时渲染编辑器
**难点**：实现类似Obsidian的实时渲染效果
**解决方案**：
- 使用Monaco Editor作为编辑器
- 集成Markdown解析器（marked.js）
- 实现双向同步和实时预览
- 支持数学公式、图表等扩展语法

### 2. 大文件处理
**难点**：处理大型笔记文件时的性能问题
**解决方案**：
- 实现虚拟滚动
- 分块加载和渲染
- 增量更新机制
- 内存管理和垃圾回收

### 3. 跨平台兼容性
**难点**：确保在不同操作系统上的兼容性
**解决方案**：
- 使用Electron的跨平台特性
- 测试不同操作系统的文件路径处理
- 处理不同平台的快捷键和UI差异

### 4. AI服务稳定性
**难点**：处理AI服务的网络异常和限流
**解决方案**：
- 实现重试机制和降级策略
- 本地缓存AI响应
- 支持离线模式
- 多服务商故障转移

---

## 部署和分发

### 1. 应用打包
```json
// package.json
{
  "scripts": {
    "build": "vite build",
    "electron:build": "electron-builder",
    "dist": "npm run build && npm run electron:build"
  },
  "build": {
    "appId": "com.memorynote.app",
    "productName": "MemoryNote",
    "directories": {
      "output": "dist-electron"
    },
    "files": [
      "dist/**/*",
      "node_modules/**/*"
    ],
    "win": {
      "target": "nsis",
      "icon": "build/icon.ico"
    },
    "mac": {
      "target": "dmg",
      "icon": "build/icon.icns"
    },
    "linux": {
      "target": "AppImage",
      "icon": "build/icon.png"
    }
  }
}
```

### 2. 自动更新
```typescript
// services/updateService.ts
export class UpdateService {
  async checkForUpdates(): Promise<boolean> {
    // 检查更新逻辑
    const latestVersion = await this.getLatestVersion()
    const currentVersion = app.getVersion()
    
    return this.compareVersions(latestVersion, currentVersion) > 0
  }
  
  async downloadUpdate(): Promise<void> {
    // 下载更新包
  }
  
  async installUpdate(): Promise<void> {
    // 安装更新
  }
}
```

---

## 总结

MemoryNote项目是一个功能丰富的个人学习知识库系统，结合了现代前端技术、AI技术和科学的学习方法。通过模块化的架构设计、完善的插件系统和强大的AI集成，为用户提供了智能化的知识管理体验。

项目的成功实施需要：
1. 扎实的前端开发基础
2. 对AI技术的深入理解
3. 良好的软件架构设计能力
4. 用户体验设计思维
5. 持续的学习和技术更新

通过分阶段的开发计划，可以逐步实现所有功能，最终打造出一个真正智能化的个人知识管理平台。
